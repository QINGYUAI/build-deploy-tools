"use strict";(self["webpackChunkmeetingvue3"]=self["webpackChunkmeetingvue3"]||[]).push([[8055],{8055:function(e,a,l){l.r(a),l.d(a,{default:function(){return y}});var t=l(20641),r=l(90033);const n={class:"web-publish"},o={class:"search-area"},s={class:"table-area"},u=["href"],i={class:"pagination"},p={class:"dialog-footer"};function d(e,a,l,d,m,g){const c=(0,t.g2)("el-input"),b=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-tag"),k=(0,t.g2)("el-option"),f=(0,t.g2)("el-select"),y=(0,t.g2)("el-button"),F=(0,t.g2)("el-form"),v=(0,t.g2)("el-table-column"),w=(0,t.g2)("el-table"),_=(0,t.g2)("el-pagination"),S=(0,t.g2)("el-dialog"),C=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",o,[(0,t.bF)(F,{inline:!0,model:d.searchForm},{default:(0,t.k6)(()=>[(0,t.bF)(b,{label:"会议ID"},{default:(0,t.k6)(()=>[(0,t.bF)(c,{modelValue:d.searchForm.meetingId,"onUpdate:modelValue":a[0]||(a[0]=e=>d.searchForm.meetingId=e),placeholder:"请输入会议ID"},null,8,["modelValue"])]),_:1}),(0,t.bF)(b,{label:"申请人"},{default:(0,t.k6)(()=>[(0,t.bF)(c,{modelValue:d.searchForm.fullName,"onUpdate:modelValue":a[1]||(a[1]=e=>d.searchForm.fullName=e),placeholder:"请输入申请人"},null,8,["modelValue"])]),_:1}),(0,t.bF)(b,{label:"申请状态"},{default:(0,t.k6)(()=>[(0,t.bF)(f,{modelValue:d.searchForm.applyStatus,"onUpdate:modelValue":a[2]||(a[2]=e=>d.searchForm.applyStatus=e),placeholder:"请选择申请状态",clearable:"",style:{width:"200px"}},{default:(0,t.k6)(()=>[(0,t.bF)(k,{label:"待审核",value:"1"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{type:"warning",size:"small"},{default:(0,t.k6)(()=>[...a[7]||(a[7]=[(0,t.eW)("待审核",-1)])]),_:1})]),_:1}),(0,t.bF)(k,{label:"审核通过",value:"2"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{type:"success",size:"small"},{default:(0,t.k6)(()=>[...a[8]||(a[8]=[(0,t.eW)("审核通过",-1)])]),_:1})]),_:1}),(0,t.bF)(k,{label:"审核拒绝",value:"3"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{type:"danger",size:"small"},{default:(0,t.k6)(()=>[...a[9]||(a[9]=[(0,t.eW)("审核拒绝",-1)])]),_:1})]),_:1}),(0,t.bF)(k,{label:"待审核(已关闭)",value:"4"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{type:"info",size:"small"},{default:(0,t.k6)(()=>[...a[10]||(a[10]=[(0,t.eW)("待审核(已关闭)",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(b,null,{default:(0,t.k6)(()=>[(0,t.bF)(y,{type:"primary",onClick:d.handleSearch},{default:(0,t.k6)(()=>[...a[11]||(a[11]=[(0,t.eW)("查询",-1)])]),_:1},8,["onClick"]),(0,t.bF)(y,{onClick:d.resetSearch},{default:(0,t.k6)(()=>[...a[12]||(a[12]=[(0,t.eW)("重置",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),(0,t.Lk)("div",s,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(w,{data:d.tableData,style:{width:"100%"},stripe:"","span-method":d.handleSpanMethod},{default:(0,t.k6)(()=>[(0,t.bF)(v,{prop:"meetingName",label:"会议名称",width:"120"}),(0,t.bF)(v,{prop:"meetingId",label:"会议ID",width:"100"}),(0,t.bF)(v,{prop:"fullName",label:"申请人",width:"100"}),(0,t.bF)(v,{prop:"meetingType",label:"网站类型",width:"100"},{default:(0,t.k6)(e=>[(0,t.eW)((0,r.v_)("pccn"===e.row.meetingType?"中文站":"mcn"===e.row.meetingType?"中文微站":"pcen"===e.row.meetingType?"英文站":"men"===e.row.meetingType?"英文微站":e.row.meetingType),1)]),_:1}),(0,t.bF)(v,{prop:"meetingUrl",label:"网站预览","min-width":"200"},{default:(0,t.k6)(e=>[(0,t.Lk)("a",{type:"primary",style:{color:"blue","text-decoration":"underline"},href:e.row.meetingUrl,target:"_blank"},(0,r.v_)(e.row.meetingUrl),9,u)]),_:1}),(0,t.bF)(v,{prop:"",label:"编辑网站",width:"120"},{default:(0,t.k6)(e=>[(0,t.bF)(y,{type:"default",size:"small",onClick:a=>d.handleEditWebsite(e.row)},{default:(0,t.k6)(()=>[...a[13]||(a[13]=[(0,t.eW)(" 前往> ",-1)])]),_:1},8,["onClick"])]),_:1}),(0,t.bF)(v,{prop:"applyTime",label:"申请时间",width:"120"}),(0,t.bF)(v,{prop:"applyStatus",label:"申请状态",width:"130"},{default:(0,t.k6)(e=>[(0,t.bF)(h,{type:d.getStatusType(e.row.applyStatus)},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(d.getStatusText(e.row.applyStatus)),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(v,{prop:"applyRemark",label:"审核备注",width:"200"}),(0,t.bF)(v,{label:"操作",width:"210",fixed:"right"},{default:(0,t.k6)(e=>[(0,t.bF)(y,{type:2==e.row.applyStatus?"info":"success",size:"small",onClick:a=>2==e.row.applyStatus?d.handleClose(e.row):d.handleApprove(e.row)},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(2==e.row.applyStatus?"关闭网站":"发布网站"),1)]),_:2},1032,["type","onClick"]),(0,t.bF)(y,{type:"danger",size:"small",onClick:a=>d.handleReject(e.row)},{default:(0,t.k6)(()=>[...a[14]||(a[14]=[(0,t.eW)("驳回发布申请",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","span-method"])),[[C,d.loading]]),(0,t.Lk)("div",i,[(0,t.bF)(_,{background:"",layout:"sizes, prev, pager, next, jumper, total","current-page":d.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>d.currentPage=e),"page-size":d.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>d.pageSize=e),total:d.total,"page-sizes":[10,20,50,100],onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),(0,t.bF)(S,{modelValue:d.dialogVisible,"onUpdate:modelValue":a[6]||(a[6]=e=>d.dialogVisible=e),title:"驳回原因",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:(0,t.k6)(()=>[(0,t.Lk)("span",p,[(0,t.bF)(y,{onClick:d.cancelDialog},{default:(0,t.k6)(()=>[...a[15]||(a[15]=[(0,t.eW)("取消",-1)])]),_:1},8,["onClick"]),(0,t.bF)(y,{type:"primary",onClick:d.submitApproval},{default:(0,t.k6)(()=>[...a[16]||(a[16]=[(0,t.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,t.k6)(()=>[(0,t.bF)(F,{model:d.approvalForm,rules:e.rules,ref:"approvalFormRef","label-width":"80px"},{default:(0,t.k6)(()=>[(0,t.bF)(b,{label:"驳回原因",prop:"remark",rules:[{required:!0,message:"请输入驳回原因",trigger:"blur"},{min:2,message:"驳回原因至少2个字符",trigger:"blur"}]},{default:(0,t.k6)(()=>[(0,t.bF)(c,{modelValue:d.approvalForm.remark,"onUpdate:modelValue":a[5]||(a[5]=e=>d.approvalForm.remark=e),type:"textarea",rows:3,placeholder:"请输入驳回原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}var m=l(50953),g=l(95531),c=l(49449),b=l(71029),h={name:"WebPublish",setup(){const e=(0,b.rd)(),a=(0,m.Kh)({meetingId:"",fullName:"",applyStatus:""}),l=(0,m.KR)([]),r=(0,m.KR)(!1),n=(0,m.KR)(1),o=(0,m.KR)(8),s=(0,m.KR)(0),u=(0,m.KR)(!1),i=(0,m.KR)("approve"),p=(0,m.KR)(null),d=(0,m.KR)(null),h=(0,m.Kh)({remark:""}),k=a=>{sessionStorage.setItem("meeting",a.meetingId),a.meetingName,sessionStorage.setItem("meetingname",a.meetingName);const l=e.resolve({path:"/homePage",query:{meeting:a.meetingId}});window.open(l.href)},f=async()=>{r.value=!0;try{const e={page:n.value,pageSize:o.value,applyType:1,...a},t=await c.A.getwebpublishlist(e);1===t.data.status?(g.nk.success(t.data.message),l.value=t.data.list,s.value=t.data.total):g.nk.error(t.data.message)}catch(e){console.error("获取列表失败：",e),g.nk.error("获取列表失败")}finally{r.value=!1}},y=()=>{n.value=1,f()},F=()=>{a.meetingId="",a.fullName="",a.applyStatus="",y()},v=e=>{o.value=e,f()},w=e=>{n.value=e,f()},_=e=>{const a={1:"待审核",2:"审核通过",3:"审核拒绝",4:"待审核(已关闭)"};return a[e]||"未知状态"},S=e=>{const a={1:"warning",2:"success",3:"danger",4:"info"};return a[e]||"info"},C=e=>{V(e,"2")},I=e=>{V(e,"4")},z=e=>{p.value=e,u.value=!0},V=async(e,a,l="")=>{try{const t={userId:e.userId,meetingId:e.meetingId,applyRemark:l,applyStatus:a},r=await c.A.getwebPublishApply(t);1===r.data.status?(g.nk.success(r.data.message),"3"===a&&(u.value=!1,h.remark=""),f()):g.nk.error(r.data.message)}catch(t){console.error("审核失败：",t),g.nk.error("审核失败")}},W=()=>{d.value.resetFields(),u.value=!1},R=async()=>{d.value&&await d.value.validate((e,a)=>{e?V(p.value,"3",h.remark):console.log("验证失败",a)})},T=({row:e,column:a,rowIndex:t,columnIndex:r})=>{if(0===r||1===r||2===r||6===r||7===r||8===r||9===r){if(0!==t){const a=l.value[t-1];if(a&&a.meetingId===e.meetingId)return{rowspan:0,colspan:1}}let a=1;for(let r=t+1;r<l.value.length;r++){if(l.value[r].meetingId!==e.meetingId)break;a++}if(a>1)return{rowspan:a,colspan:1}}return{rowspan:1,colspan:1}};return(0,t.sV)(()=>{f()}),{searchForm:a,tableData:l,loading:r,handleSpanMethod:T,currentPage:n,pageSize:o,total:s,dialogVisible:u,dialogType:i,approvalForm:h,approvalFormRef:d,handleSearch:y,resetSearch:F,handleSizeChange:v,handleCurrentChange:w,getStatusText:_,getStatusType:S,handleApprove:C,handleClose:I,handleReject:z,handleEditWebsite:k,submitApproval:R,cancelDialog:W}}},k=l(66262);const f=(0,k.A)(h,[["render",d],["__scopeId","data-v-47e2634f"]]);var y=f}}]);