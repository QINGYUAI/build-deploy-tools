"use strict";(self["webpackChunkmeetingvue3"]=self["webpackChunkmeetingvue3"]||[]).push([[9161],{15992:function(e,t,a){a.d(t,{A:function(){return p}});var l=a(20641),i=a(90033),o=a(50953);const n={style:{color:"var(--el-color-danger)"}},s={style:{color:"var(--el-color-danger)"}},u={style:{color:"var(--el-color-danger)"}},r={style:{color:"var(--el-color-danger)"}},d={style:{color:"var(--el-color-danger)"}},c={style:{color:"var(--el-color-danger)"}};var m={__name:"InvoiceMoney",props:{number:{type:Object,default:()=>({blueticketMoney:0,blueticketNumber:0,meetingId:0,redticketMoney:0,redticketNumber:0,amount:0,taxrateamount:0,openedAmount:0})}},setup(e){const t=e,a=(0,o.Kh)({numbers:t.number}),{numbers:m}=(0,o.QW)(a);function g(){a.numbers.blueticketMoney=(a.numbers.blueticketMoney-0).toFixed(2),a.numbers.redticketMoney=(a.numbers.redticketMoney-0).toFixed(2)}return(0,l.wB)(()=>t.number,()=>g(),{deep:!0}),(e,t)=>{const a=(0,l.g2)("el-tag");return(0,l.uX)(),(0,l.Wv)(a,{type:"primary",class:"invoiceStatistics"},{default:(0,l.k6)(()=>[t[0]||(t[0]=(0,l.eW)(" 发票总开张数和金额：蓝票 ",-1)),(0,l.Lk)("span",n,(0,i.v_)((0,o.R1)(m).blueticketNumber),1),t[1]||(t[1]=(0,l.eW)(" 张， 红票 ",-1)),(0,l.Lk)("span",s,(0,i.v_)((0,o.R1)(m).redticketNumber),1),t[2]||(t[2]=(0,l.eW)(" 张 ,蓝票金额 ",-1)),(0,l.Lk)("span",u,(0,i.v_)((0,o.R1)(m).blueticketMoney),1),t[3]||(t[3]=(0,l.eW)(" 元， 红票金额 ",-1)),(0,l.Lk)("span",r,(0,i.v_)((0,o.R1)(m).redticketMoney),1),t[4]||(t[4]=(0,l.eW)(" 元， 不含税金额 ",-1)),(0,l.Lk)("span",d,(0,i.v_)((0,o.R1)(m).amount),1),t[5]||(t[5]=(0,l.eW)(" ， 税金 ",-1)),(0,l.Lk)("span",c,(0,i.v_)((0,o.R1)(m).taxrateamount),1)]),_:1})}}};const g=m;var p=g},17405:function(e,t,a){a.d(t,{A:function(){return r}});var l=a(20641),i=a(90033),o=a(50953);const n={class:"sectionInvoice"};var s={__name:"DigitalItem",props:["item","invoiceCofing"],setup(e){const t=(0,o.Kh)({denglu:["未登录","已登录"],renzheng:["未知","已认证","待认证"],dlzt:["未登录","登录中(待输入校验码)","已登录"],rzzt:["失效","有效"]}),{denglu:a,renzheng:s,dlzt:u,rzzt:r}=(0,o.QW)(t);return(t,d)=>{const c=(0,l.g2)("el-popover");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("span",null,[void 0!==e.item.Name?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.eW)((0,i.v_)(e.item.Name)+" - ",1)],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)(" 开票人（暂无数据）- ")],64)),(0,l.eW)(" "+(0,i.v_)(e.item.name),1)]),(0,l.Lk)("section",n,[3==e.invoiceCofing?.type?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.item.denglu?((0,l.uX)(),(0,l.Wv)(c,{key:0,placement:"top",trigger:"hover",content:e.item.denglu.result?"当前登录状态为"+((0,o.R1)(a)[e.item.denglu.result.certificationStatus-0]||"未知"):e.item.denglu.describe},{reference:(0,l.k6)(()=>[(0,l.Lk)("p",null,[(0,l.Lk)("span",{class:(0,i.C4)(["denglu dian",1==(e.item.denglu.result&&e.item.denglu.result.certificationStatus)?"true":"false"])},null,2),d[0]||(d[0]=(0,l.Lk)("span",null," 登录 ",-1))])]),_:1},8,["content"])):(0,l.Q3)("",!0),e.item.renzheng?((0,l.uX)(),(0,l.Wv)(c,{key:1,placement:"top",trigger:"hover",content:e.item.renzheng.result?"当前开票认证状态为"+((0,o.R1)(s)[e.item.renzheng.result.certificationStatus-0]||"未知"):e.item.renzheng.describe},{reference:(0,l.k6)(()=>[(0,l.Lk)("p",null,[(0,l.Lk)("span",{class:(0,i.C4)(["renzheng dian",1==(e.item.renzheng.result&&e.item.renzheng.result.certificationStatus)?"true":"false"])},null,2),d[1]||(d[1]=(0,l.Lk)("span",null,"认证",-1))])]),_:1},8,["content"])):(0,l.Q3)("",!0)],64)):4==e.invoiceCofing?.type?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[e.item.renzheng?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.bF)(c,{placement:"top",trigger:"hover",content:e.item.renzheng.list?"当前登录状态为"+((0,o.R1)(u)[e.item.renzheng.list.dlzt]||"未知"):""},{reference:(0,l.k6)(()=>[(0,l.Lk)("p",null,[(0,l.Lk)("span",{class:(0,i.C4)(["denglu dian",e.item.renzheng.list&&2==e.item.renzheng.list.dlzt?"true":"false"])},null,2),d[2]||(d[2]=(0,l.Lk)("span",null," 登录 ",-1))])]),_:1},8,["content"]),(0,l.bF)(c,{placement:"top",trigger:"hover",content:e.item.renzheng.list?"当前开票认证状态为"+((0,o.R1)(r)[e.item.renzheng.list.rzzt]||"未知"):""},{reference:(0,l.k6)(()=>[(0,l.Lk)("p",null,[(0,l.Lk)("span",{class:(0,i.C4)(["renzheng dian",e.item.renzheng.list&&1==e.item.renzheng.list.rzzt?"true":"false"])},null,2),d[3]||(d[3]=(0,l.Lk)("span",null,"认证",-1))])]),_:1},8,["content"])],64)):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0)])],64)}}};const u=s;var r=u},29491:function(e,t,a){a.d(t,{A:function(){return y}});a(18111),a(20116),a(33110);var l=a(20641),i=a(50953),o=a(90033),n=a(86244),s=a(17405),u=a(67608),r=a(40834);const d={style:{"text-align":"center"}},c={class:"Qrcode"},m={key:0,style:{"text-align":"center"},class:"approveData"},g={key:1,style:{display:"flex","align-items":"center","flex-direction":"column"}},p=["src"];var v={__name:"DigitalView",props:["DigitalData","type","loading"],emits:["getQrCodeStatus"],setup(e,{emit:t}){const{proxy:a}=(0,l.nI)(),v=(0,r.Pj)(),f=e,y=t,k=(0,l.WQ)("invoiceConfig");function b(){console.log(v.state.isTicket[f.type],"store.state.isTicket[props.type]"),v.state.isTicket[f.type]?L.dialogVisible=!0:a.$message({type:"warning",message:"非数电配置，不可使用登录认证"})}const _=(0,l.EW)(()=>{let e={};return k.value.cn&&(e=k.value.cn.find(e=>1===e.invoiceHasSite[f.type])),e}),{invoiceFlag:C,cancellationDia:h,cancellationRef:R,cancellationType:D,figure:L,authenticationclose:F,Digitalclose:w,DigitalAuthRefresh:I,clerkId:W,DigitalFlag:x,DigitalAuthentication:z,Digitalrieister:$,Digitalold:V,dialogClose:Q}=(0,u.A)(),{qrCode:E,QRCodetext:S,djs:X,yzm:A,authentication:q,DigitalLogin:N,form:T,rules:K,formRef:j,approveData:M,authData:Y,dialogVisible:U}=(0,i.QW)(L);return(0,l.wB)(()=>_.value,e=>{L.itemConfig=e},{immediate:!0}),(t,a)=>{const u=(0,l.g2)("el-button"),r=(0,l.g2)("el-radio"),v=(0,l.g2)("el-radio-group"),f=(0,l.g2)("el-form-item"),k=(0,l.g2)("el-input"),C=(0,l.g2)("el-form"),h=(0,l.g2)("el-radio-button"),R=(0,l.g2)("el-row"),D=(0,l.g2)("el-text"),L=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(u,{onClick:b,style:{"margin-left":"12px"},size:"small",type:"primary",loading:e.loading},{default:(0,l.k6)(()=>[...a[8]||(a[8]=[(0,l.eW)("登录认证",-1)])]),_:1},8,["loading"]),(0,l.bF)(L,{class:"DigitalLogin",title:"登录认证",width:"900",modelValue:(0,i.R1)(U),"onUpdate:modelValue":a[7]||(a[7]=e=>(0,i.i9)(U)?U.value=e:null),"before-close":(...e)=>(0,i.R1)(Q)(()=>y("getQrCodeStatus",...e))},{default:(0,l.k6)(()=>[(0,l.Lk)("div",d,[(0,l.bF)(C,{class:"formRules",model:(0,i.R1)(T),ref_key:"formRef",ref:j,rules:(0,i.R1)(K)},{default:(0,l.k6)(()=>[(0,l.bF)(f,{label:"开票人:",prop:"extNumber"},{default:(0,l.k6)(()=>[(0,l.bF)(v,{modelValue:(0,i.R1)(T).extNumber,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,i.R1)(T).extNumber=e),disabled:(0,i.R1)(X)<120},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.DigitalData,(e,t)=>((0,l.uX)(),(0,l.Wv)(r,{key:t,value:JSON.stringify(e)},{default:(0,l.k6)(()=>[(0,l.bF)(s.A,{item:e,invoiceCofing:_.value},null,8,["item","invoiceCofing"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),(0,i.R1)(W)&&!(0,i.R1)(x)?((0,l.uX)(),(0,l.Wv)(f,{key:0,label:"验证码",prop:"Digital"},{default:(0,l.k6)(()=>[(0,l.bF)(k,{modelValue:(0,i.R1)(T).Digital,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,i.R1)(T).Digital=e),disabled:(0,i.R1)(W)&&(0,i.R1)(N)},{append:(0,l.k6)(()=>[(0,l.bF)(u,{link:"",size:"small",type:"primary",onClick:(0,i.R1)(V),disabled:120!=(0,i.R1)(X)},{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)((0,i.R1)(A)),1)]),_:1},8,["onClick","disabled"])]),_:1},8,["modelValue","disabled"]),(0,i.R1)(W)&&!(0,i.R1)(x)?((0,l.uX)(),(0,l.Wv)(u,{key:0,disabled:(0,i.R1)(N),type:"primary",size:"small",onClick:a[2]||(a[2]=e=>(0,i.R1)($)((...e)=>y("getQrCodeStatus",...e)))},{default:(0,l.k6)(()=>[...a[9]||(a[9]=[(0,l.eW)(" 验证 ",-1)])]),_:1},8,["disabled"])):(0,l.Q3)("",!0)]),_:1})):(0,l.Q3)("",!0)]),_:1},8,["model","rules"]),(0,i.R1)(x)||(0,i.R1)(N)?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.Lk)("div",c,[(0,i.R1)(W)?((0,l.uX)(),(0,l.Wv)(R,{key:0},{default:(0,l.k6)(()=>[(0,i.R1)(T).extNumber?((0,l.uX)(),(0,l.Wv)(v,{key:0,modelValue:(0,i.R1)(T).qrCode,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,i.R1)(T).qrCode=e),size:"large",onChange:a[4]||(a[4]=e=>(0,i.R1)(z)()),disabled:(0,i.R1)(M).qrCode},{default:(0,l.k6)(()=>[(0,l.bF)(h,{size:"small",label:"税务局二维码",value:0}),(0,l.bF)(h,{size:"small",label:"个税二维码",value:1})]),_:1},8,["modelValue","disabled"])):(0,l.Q3)("",!0)]),_:1})):(0,l.Q3)("",!0)]),3==_.value.type?((0,l.uX)(),(0,l.CE)("div",m,[(0,i.R1)(M).account?((0,l.uX)(),(0,l.Wv)(R,{key:0,class:"account"},{default:(0,l.k6)(()=>[(0,l.bF)(D,null,{default:(0,l.k6)(()=>[...a[10]||(a[10]=[(0,l.eW)(" 认证人号码： ",-1)])]),_:1}),(0,l.bF)(D,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)((0,i.R1)(M).account),1)]),_:1})]),_:1})):(0,l.Q3)("",!0),(0,i.R1)(M).qrCode?((0,l.uX)(),(0,l.Wv)(n.A,{key:1,width:75,height:75,QRCodetext:(0,i.R1)(M).qrCode},null,8,["QRCodetext"])):(0,l.Q3)("",!0),(0,i.R1)(M).endTime?((0,l.uX)(),(0,l.Wv)(R,{key:2,style:{"margin-top":"0"}},{default:(0,l.k6)(()=>[(0,l.bF)(D,null,{default:(0,l.k6)(()=>[...a[11]||(a[11]=[(0,l.eW)(" 生成时间： ",-1)])]),_:1}),(0,l.bF)(D,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)((0,i.R1)(M).endTime),1)]),_:1})]),_:1})):(0,l.Q3)("",!0),(0,l.bF)(u,{style:{margin:"10px 0"},type:"primary",size:"small",onClick:a[5]||(a[5]=()=>y("getQrCodeStatus"))},{default:(0,l.k6)(()=>[...a[12]||(a[12]=[(0,l.eW)("刷新当前认证状态",-1)])]),_:1})])):4==_.value.type?((0,l.uX)(),(0,l.CE)("div",g,[(0,i.R1)(S)?((0,l.uX)(),(0,l.CE)("img",{key:0,class:"QRCodetext",src:(0,i.R1)(S),alt:""},null,8,p)):(0,l.Q3)("",!0),(0,l.bF)(u,{style:{margin:"10px 0"},type:"primary",size:"small",onClick:a[6]||(a[6]=()=>y("getQrCodeStatus"))},{default:(0,l.k6)(()=>[...a[13]||(a[13]=[(0,l.eW)("刷新当前认证状态",-1)])]),_:1})])):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0)])]),_:1},8,["modelValue","before-close"])],64)}}};const f=v;var y=f},39161:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});a(44114),a(18111),a(20116),a(61701),a(18237);var l=a(20641),i=a(90033),o=a(50953),n=a(40834),s=a(17405);const u={class:"dialog-footer"};var r={__name:"blueRedInvoice",props:{row:{type:Object,default:()=>({cn:[]})},DigitalData:{type:Object,default:()=>[]}},emits:["GetInvoiceList"],setup(e,{emit:t}){const a=(0,l.WQ)("invoiceConfig"),i=(0,n.Pj)(),r=e,d=t,{proxy:c}=(0,l.nI)(),m=(0,o.KR)(""),g=(0,o.KR)(!1);function p(e){if(""===m.value)return void c.$message({type:"warning",message:"请选择冲红人"});const t={id:e.id,committeeId:i.state.user.committeeId,type_vue:1};t.ext_number=r.DigitalData.findIndex(e=>e.name===m.value.split("-")[1])+1,c.$Loadimg.showLoading(),c.$http.article.CommitteeInvoiceAdminInvoiceDigital(t).then(async e=>{c.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status?(c.$message({type:"success",message:e.data.msg}),g.value=!1):c.$message({type:"error",message:e.data.msg}),await d("GetInvoiceList")}).catch(e=>{console.error(e)})}return(t,i)=>{const n=(0,l.g2)("el-button"),r=(0,l.g2)("el-option"),d=(0,l.g2)("el-select"),c=(0,l.g2)("el-form-item"),v=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)(l.FK,null,[3!==e.row.invoiceStatus?((0,l.uX)(),(0,l.Wv)(n,(0,l.v6)({key:0,color:"#FF2A00",type:"primary",size:"small"},t.$attrs,{onClick:i[0]||(i[0]=e=>g.value=!0),style:{"margin-right":"12px"}}),{default:(0,l.k6)(()=>[...i[6]||(i[6]=[(0,l.eW)("冲红 ",-1)])]),_:1},16)):(0,l.Q3)("",!0),(0,l.bF)(v,{modelValue:g.value,"onUpdate:modelValue":i[4]||(i[4]=e=>g.value=e),title:"确定冲红？",width:"500",class:"dialog_redInvoice DiaHCenter","append-to-body":!0,onClose:i[5]||(i[5]=()=>{m.value="",g.value=!1})},{footer:(0,l.k6)(()=>[(0,l.Lk)("div",u,[(0,l.bF)(n,{onClick:i[2]||(i[2]=e=>g.value=!1)},{default:(0,l.k6)(()=>[...i[7]||(i[7]=[(0,l.eW)("取消",-1)])]),_:1}),(0,l.bF)(n,{type:"primary",onClick:i[3]||(i[3]=t=>p(e.row))},{default:(0,l.k6)(()=>[...i[8]||(i[8]=[(0,l.eW)(" 确认 ",-1)])]),_:1})])]),default:(0,l.k6)(()=>[(0,l.bF)(c,{label:"请选择冲红人"},{default:(0,l.k6)(()=>[e.DigitalData.length>=1?((0,l.uX)(),(0,l.Wv)(d,{key:0,style:{width:"100px"},modelValue:m.value,"onUpdate:modelValue":i[1]||(i[1]=e=>m.value=e),"popper-class":"popper-select"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.DigitalData,(e,t)=>((0,l.uX)(),(0,l.Wv)(r,{key:t,value:(e.Name||"开票人（暂无数据）")+"-"+e.name},{default:(0,l.k6)(()=>[(0,l.bF)(s.A,{item:e,invoiceCofing:(0,o.R1)(a).cn[0]},null,8,["item","invoiceCofing"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):(0,l.Q3)("",!0)]),_:1})]),_:1},8,["modelValue"])],64)}}};const d=r;var c=d,m=a(50419),g=a(78365),p=(a(15992),a(29491)),v=a(60894),f=a(71029),y=a(67028),k=a(63693);const b={class:"blueInvoice"},_={class:"box"},C={class:"top"},h={class:"fontRed color"},R={class:"color"},D={class:"bottom"},L={class:"fontRed color"},F={class:"color"},w={class:"color"},I={class:"top"},W={class:"table"},x={class:"handle"},z={style:{width:"100%",display:"flex","justify-content":"center"}},$={class:"scope_btn"};var V={__name:"index",setup(e){const t=(0,n.Pj)(),{proxy:a}=(0,l.nI)(),[s,u]=[(0,f.rd)(),(0,f.lq)()],{invoiceListType:r}=(0,v.A)(),d=(0,o.KR)({usedCreditLine:0,totalCreditLine:0,invoicedAmount:0,invoicedTax:0,invoicedBlueCount:0});function V(){const e={committee_id:t.state.user.committeeId,queryType:"1"};a.$http.article.CommitteeInvoiceGetCreditLine(e).then(e=>{const{status:t,list:l,msg:i}=e.data;200===t?Array.isArray(l)||"E0000"!==l.code||(d.value=l.result):a.$message.error(i)})}(0,o.Kh)({blueticketMoney:0,blueticketNumber:0,meetingId:0,redticketMoney:0,redticketNumber:0,amount:0,taxrateamount:0,openedAmount:0});(0,l.sV)(()=>{});const Q=(0,o.Kh)({invoiceType:[{value:0,label:"全部",num:0},...r],InvoicingStatus:[{value:"",label:"全部"},{value:"0",label:"已开票"},{value:"3",label:"已冲红"},{value:"7",label:"开票失败"},{value:"1",label:"冲红中"},{value:"6",label:"开票中"}],kpTypeList:[{value:"",label:"全部"},{value:"1",label:"蓝票"},{value:"2",label:"红票"}],formData:{invoiceType:"",kptype:"",invoiceStatus:"",fphm:"",date:[]},formRef:null}),{invoiceType:E,InvoicingStatus:S,formData:X,formRef:A,kpTypeList:q}=(0,o.QW)(Q);function N(e){e?.resetFields(),Y()}const T=(0,o.Kh)({loading:!1,tableData:[],paginateData:{total:0,page:1,per_page:10}}),{tableData:K,paginateData:j,loading:M}=(0,o.QW)(T);async function Y(){const e={type_vue:1,committeeId:t.state.user.committeeId,...Q.formData,page:T.paginateData.page,per_page:T.paginateData.per_page};Q.formData.date.length>0?(e.startDate=a.$dayjs(Q.formData.date[0]).format("YYYY-MM-DD"),e.endDate=a.$dayjs(Q.formData.date[1]).format("YYYY-MM-DD")):(e.startDate="",e.endDate=""),T.loading=!0;try{const t=await a.$http.article.CommitteeInvoiceAdminAjaxIndex(e);if(T.loading=!1,1===t.data.status||200===t.data.status){V(),T.tableData=t.data.list.map(e=>(e.loading=!0,e)),T.paginateData={...t.data.pageinfo,page:t.data.pageinfo.page,per_page:t.data.pageinfo.per_page},a.$message({type:"success",message:"获取成功"});for(let e of T.tableData)await de(e)}else a.$message({type:"error",message:"获取失败"})}catch(l){console.error(l)}}(0,l.wB)(()=>t.state.user.committeeId,e=>{e&&Y()},{immediate:!0});(0,o.KR)(1);(0,l.wB)(()=>T.paginateData,async(e,t)=>{e&&0!==t.total&&(t&&t.page===e.page&&t.per_page===e.per_page||!T.loading&&await Y())},{deep:!0});const U=(0,o.Kh)({IssueDialog:!1,IssueValue:5,IssueList:[...r]}),{IssueDialog:B,IssueValue:O,IssueList:P}=(0,o.QW)(U);function G({row:e}){let t="";return e&&(2===e.kptype&&3===e.invoiceStatus?t="blush":7===e.invoiceStatus&&(t="rejected")),t}function H(){U.IssueDialog=!0}function J(){U.IssueValue=5}function Z(){s.push({path:"/IssueInvoice",query:{...u.query,type:U.IssueValue}})}function ee(e){window.open(e.url)}function te(e){s.push({path:"/IssueInvoice",query:{...u.query,type:e.invoiceType,id:e.id}})}function ae(e){const l={dataId:e.id,committeeId:t.state.user.committeeId,type_vue:1};a.$Loadimg.showLoading(),a.$http.article.CommitteeInvoiceRefreshInvoice(l).then(async e=>{a.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status?a.$message({type:"success",message:"刷新成功"}):a.$message({type:"error",message:"刷新失败"}),await Y()}).catch(e=>{console.log(e)})}function le(e){const l={did:e.id,committeeId:t.state.user.committeeId,type_vue:1};a.$Loadimg.showLoading(),a.$http.article.CommitteeInvoiceAdmInvoiceGetDetail(l).then(async e=>{a.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status?a.$message({type:"success",message:e.data.msg}):a.$message({type:"error",message:e.data.msg}),await Y()}).catch(e=>{console.error(e)})}const{CodeStatus:ie,DigitalData:oe,getQrCodeStatus:ne,invoiceConfig:se}=(0,y.A)(a),ue=(0,l.EW)(()=>({cn:[{...se.value,invoiceHasSite:{committee:1}}]}));function re(){const e={committeeId:t.state.user.committeeId,type_vue:1};a.$Loadimg.showLoading(),a.$http.article.CommitteeInvoiceConfigList(e).then(e=>{if(a.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status){const{config:i,list:o}=e.data.list;try{se.value=i.find(e=>o.find(t=>1===t.status&&t.invoiceConfigId===e.configId))||{},t.commit("setTicket",{...t.state.isTicket,committee:1}),ne()}catch(l){a.$message.error(e.data.msg)}}else a.$message.error(e.data.msg)})}async function de(e){const l={id:e.id,type_vue:1,committeeId:t.state.user.committeeId},i=await a.$http.article.CommitteeInvoiceDetail(l);if(1===i.data.status||200===i.data.status)try{const{invoiceData:t,invoiceDetail:l}=i.data.list;e.total=t.invoiceAmount,e.taxAmount=l?.reduce((e,t)=>{const l=t.taxrate.slice(0,t.taxrate.length-1)/100,i=Number(a.$calc(" a * b / c / (1 + b) * c * c",{a:t.dj,b:l,c:t.number})).toFixed(2);return e+=Number(i),e},0),e.taxAmount=Number(e.taxAmount).toFixed(2),e.amount=Number(a.$calc(" a - b ",{a:e.total,b:e.total<0?-1*e.taxAmount:e.taxAmount}))}catch(o){}else console.log(i.data.msg);e.loading=!1}return(0,l.Gt)("invoiceConfig",ue),(0,l.wB)(()=>t.state.user.committeeId,e=>{e&&re()},{immediate:!0}),(e,a)=>{const n=(0,l.g2)("el-option"),r=(0,l.g2)("el-select"),v=(0,l.g2)("el-form-item"),f=(0,l.g2)("el-input"),y=(0,l.g2)("el-date-picker"),V=(0,l.g2)("el-form"),Q=(0,l.g2)("el-button"),T=(0,l.g2)("el-table-column"),U=(0,l.g2)("el-text"),ie=(0,l.g2)("el-table"),se=(0,l.g2)("el-radio"),ue=(0,l.g2)("el-radio-group"),re=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)("div",b,[(0,l.Lk)("div",_,[(0,l.Lk)("header",null,[a[16]||(a[16]=(0,l.Lk)("div",{class:"blueLine"}," 数据概览 ",-1)),(0,l.Lk)("section",null,[(0,l.Lk)("div",C,[(0,l.Lk)("div",null,[a[11]||(a[11]=(0,l.Lk)("h5",{class:"color"},"可用发票额度（申报前）",-1)),(0,l.Lk)("p",h,(0,i.v_)(d.value.usedCreditLine||0)+"元",1)]),(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[a[12]||(a[12]=(0,l.eW)("发票总额度:",-1)),(0,l.Lk)("span",R,(0,i.v_)(d.value.totalCreditLine||0)+" 元",1)])])]),(0,l.Lk)("div",D,[(0,l.Lk)("div",null,[a[13]||(a[13]=(0,l.Lk)("h5",{class:"color"},"蓝字发票开具额度： ",-1)),(0,l.Lk)("p",L,(0,i.v_)(d.value.invoicedAmount||0)+" 元",1)]),(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[a[14]||(a[14]=(0,l.eW)("累计税额：",-1)),(0,l.Lk)("span",F,(0,i.v_)(d.value.invoicedTax||0)+" 元",1)]),(0,l.Lk)("p",null,[a[15]||(a[15]=(0,l.eW)("发票数量：",-1)),(0,l.Lk)("span",w,(0,i.v_)(d.value.invoicedBlueCount||0)+" 张",1)])])])])]),(0,l.Lk)("footer",null,[(0,l.Lk)("div",null,[(0,l.Lk)("div",I,[(0,l.Lk)("div",W,[(0,l.bF)(V,{model:(0,o.R1)(X),ref_key:"formRef",ref:A,style:{"box-sizing":"border-box"}},{default:(0,l.k6)(()=>[(0,l.bF)(v,{label:"票种：",prop:"invoiceType"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{modelValue:(0,o.R1)(X).invoiceType,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,o.R1)(X).invoiceType=e),placeholder:"请选择发票票种",size:"small"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(E),e=>((0,l.uX)(),(0,l.Wv)(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"发票状态：",prop:"invoiceStatus"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{modelValue:(0,o.R1)(X).invoiceStatus,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,o.R1)(X).invoiceStatus=e),placeholder:"请选择发票状态",size:"small"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(S),e=>((0,l.uX)(),(0,l.Wv)(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"开票种类：",prop:"kptype"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{modelValue:(0,o.R1)(X).kptype,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,o.R1)(X).kptype=e),placeholder:"请选择发票状态",size:"small"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(q),e=>((0,l.uX)(),(0,l.Wv)(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"发票号码：",prop:"fphm"},{default:(0,l.k6)(()=>[(0,l.bF)(f,{modelValue:(0,o.R1)(X).fphm,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,o.R1)(X).fphm=e),modelModifiers:{trim:!0},placeholder:"请填写发票号码"},null,8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"开票时间范围：",prop:"date"},{default:(0,l.k6)(()=>[(0,l.bF)(y,{modelValue:(0,o.R1)(X).date,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,o.R1)(X).date=e),type:"daterange",size:"small",style:{margin:"5px 10px"},"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","unlink-panels":!0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),(0,l.Lk)("div",x,[(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)(Q,{type:"primary",size:"small",onClick:H,loading:(0,o.R1)(M)},{default:(0,l.k6)(()=>[...a[17]||(a[17]=[(0,l.eW)("立即开票 ",-1)])]),_:1},8,["loading"]),(0,l.bF)(Q,{type:"primary",size:"small",onClick:a[5]||(a[5]=e=>(0,o.R1)(s).push({path:"/InvoiceDraft",query:(0,o.R1)(u).query})),loading:(0,o.R1)(M)},{default:(0,l.k6)(()=>[...a[18]||(a[18]=[(0,l.eW)("发票草稿 ",-1)])]),_:1},8,["loading"]),(0,l.bF)(p.A,{type:"committee",DigitalData:(0,o.R1)(oe),onGetQrCodeStatus:(0,o.R1)(ne),loading:(0,o.R1)(M)},null,8,["DigitalData","onGetQrCodeStatus","loading"])]),_:1}),(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)(Q,{type:"primary",size:"small",onClick:Y,loading:(0,o.R1)(M)},{default:(0,l.k6)(()=>[...a[19]||(a[19]=[(0,l.eW)("查询 ",-1)])]),_:1},8,["loading"]),(0,l.bF)(Q,{onClick:a[6]||(a[6]=e=>N((0,o.R1)(A))),size:"small",loading:(0,o.R1)(M)},{default:(0,l.k6)(()=>[...a[20]||(a[20]=[(0,l.eW)("重置 ",-1)])]),_:1},8,["loading"])]),_:1})]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(ie,{data:(0,o.R1)(K),"row-class-name":G},{default:(0,l.k6)(()=>[(0,l.bF)(T,{label:"序列号","class-name":"rejectCol"},{default:(0,l.k6)(e=>[(0,l.eW)((0,i.v_)(e.$index+1),1)]),_:1}),(0,l.bF)(T,{label:"发票票种","class-name":"invoice-type"},{default:(0,l.k6)(e=>[(0,l.Lk)("div",z,[e.row.invoiceType?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"invoice-type",style:(0,i.Tr)({background:(0,o.R1)(t).state.invoiceType[(0,o.R1)(t).state.invoiceTypeArr[e.row.invoiceType]].back,color:(0,o.R1)(t).state.invoiceType[(0,o.R1)(t).state.invoiceTypeArr[e.row.invoiceType]].color})},(0,i.v_)((0,o.R1)(t).state.invoiceType[(0,o.R1)(t).state.invoiceTypeArr[e.row.invoiceType]].text),5)):(0,l.Q3)("",!0)])]),_:1}),(0,l.bF)(T,{label:"购方名称"},{default:(0,l.k6)(e=>[(0,l.eW)((0,i.v_)(e.row.buyername),1)]),_:1}),(0,l.bF)(T,{label:"合计金额"},{default:(0,l.k6)(e=>[e.row.amount?((0,l.uX)(),(0,l.Wv)(U,{key:0,type:e.row.amount<0?"danger":""},{default:(0,l.k6)(()=>[(0,l.eW)("￥"+(0,i.v_)(e.row.amount),1)]),_:2},1032,["type"])):((0,l.uX)(),(0,l.Wv)(U,{key:1},{default:(0,l.k6)(()=>[...a[21]||(a[21]=[(0,l.eW)("-",-1)])]),_:1}))]),_:1}),(0,l.bF)(T,{label:"合计税额"},{default:(0,l.k6)(e=>[e.row.taxAmount?((0,l.uX)(),(0,l.Wv)(U,{key:0},{default:(0,l.k6)(()=>[(0,l.eW)("￥"+(0,i.v_)(e.row.taxAmount),1)]),_:2},1024)):((0,l.uX)(),(0,l.Wv)(U,{key:1},{default:(0,l.k6)(()=>[...a[22]||(a[22]=[(0,l.eW)("-",-1)])]),_:1}))]),_:1}),(0,l.bF)(T,{label:"价税合计"},{default:(0,l.k6)(e=>[e.row.total?((0,l.uX)(),(0,l.Wv)(U,{key:0,type:e.row.total<0?"danger":""},{default:(0,l.k6)(()=>[(0,l.eW)("￥"+(0,i.v_)(e.row.total),1)]),_:2},1032,["type"])):((0,l.uX)(),(0,l.Wv)(U,{key:1},{default:(0,l.k6)(()=>[...a[23]||(a[23]=[(0,l.eW)("-",-1)])]),_:1}))]),_:1}),(0,l.bF)(T,{label:"数电票号码"},{default:(0,l.k6)(e=>[(0,l.eW)((0,i.v_)(e.row.fphm||"-"),1)]),_:1}),(0,l.bF)(T,{label:"开票日期"},{default:(0,l.k6)(t=>[(0,l.eW)((0,i.v_)(t.row.invoiceDate?e.$dayjs(t.row.invoiceDate).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),_:1}),(0,l.bF)(T,{label:"操作",width:"250",fixed:"right"},{default:(0,l.k6)(e=>[(0,l.Lk)("div",$,[6===e.row.invoiceStatus&&1===e.row.kptype?((0,l.uX)(),(0,l.Wv)(Q,{key:0,type:"primary",size:"small",onClick:t=>ae(e.row)},{default:(0,l.k6)(()=>[...a[24]||(a[24]=[(0,l.eW)("开票中刷新",-1)])]),_:1},8,["onClick"])):(0,l.Q3)("",!0),0===e.row.invoiceStatus||3===e.row.invoiceStatus||1===e.row.invoiceStatus?((0,l.uX)(),(0,l.Wv)(Q,{key:1,type:"primary",size:"small",onClick:t=>ee(e.row),loading:e.row.loading},{default:(0,l.k6)(()=>[...a[25]||(a[25]=[(0,l.eW)("查看发票 ",-1)])]),_:1},8,["onClick","loading"])):(0,l.Q3)("",!0),0===e.row.invoiceStatus&&1===e.row.kptype?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.bF)(c,{row:e.row,DigitalData:(0,o.R1)(oe),loading:e.row.loading,onGetInvoiceList:Y},null,8,["row","DigitalData","loading"]),(0,l.bF)(Q,{color:"#FFB800",type:"primary",size:"small",style:{color:"white"},onClick:t=>te(e.row),loading:e.row.loading},{default:(0,l.k6)(()=>[...a[26]||(a[26]=[(0,l.eW)("复制开票 ",-1)])]),_:1},8,["onClick","loading"]),(0,l.bF)((0,o.R1)(m.A),{data:{scope:e.row,type:"committee"},loading:e.row.loading},null,8,["data","loading"])],64)):6===e.row.invoiceStatus&&1!==e.row.kptype?((0,l.uX)(),(0,l.Wv)(Q,{key:3,type:"primary",size:"small",onClick:t=>le(e.row),loading:e.row.loading},{default:(0,l.k6)(()=>[...a[27]||(a[27]=[(0,l.eW)("冲红中刷新 ",-1)])]),_:1},8,["onClick","loading"])):(0,l.Q3)("",!0),7===e.row.invoiceStatus||3===e.row.invoiceStatus?((0,l.uX)(),(0,l.Wv)(Q,{key:4,color:"#FFB800",type:"primary",size:"small",style:{color:"white"},onClick:t=>te(e.row),loading:e.row.loading},{default:(0,l.k6)(()=>[...a[28]||(a[28]=[(0,l.eW)("复制开票 ",-1)])]),_:1},8,["onClick","loading"])):(0,l.Q3)("",!0)])]),_:1})]),_:1},8,["data"])),[[(0,o.R1)(k.A),(0,o.R1)(M)]])])]),(0,l.bF)(g.A,{modelValue:(0,o.R1)(j),"onUpdate:modelValue":a[7]||(a[7]=e=>(0,o.i9)(j)?j.value=e:null),layout:"prev, pager, next, sizes, total","page-sizes":[10,20,30,50]},null,8,["modelValue"])])])]),(0,l.bF)(re,{class:"IssueDialog DiaHCenter",modelValue:(0,o.R1)(B),"onUpdate:modelValue":a[10]||(a[10]=e=>(0,o.i9)(B)?B.value=e:null),title:"立即开票",width:"600",onClosed:J},{default:(0,l.k6)(()=>[(0,l.bF)(v,{class:"IssueForm",label:"电子发票选择票类：",required:!0},{default:(0,l.k6)(()=>[(0,l.bF)(ue,{modelValue:(0,o.R1)(O),"onUpdate:modelValue":a[8]||(a[8]=e=>(0,o.i9)(O)?O.value=e:null)},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(P),e=>((0,l.uX)(),(0,l.Wv)(se,{value:e.value,key:e.label},{default:(0,l.k6)(()=>[(0,l.eW)((0,i.v_)(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)(Q,{size:"small",onClick:a[9]||(a[9]=e=>B.value=!1)},{default:(0,l.k6)(()=>[...a[29]||(a[29]=[(0,l.eW)("取消 ",-1)])]),_:1}),(0,l.bF)(Q,{type:"primary",size:"small",onClick:Z},{default:(0,l.k6)(()=>[...a[30]||(a[30]=[(0,l.eW)("确认 ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Q=a(66262);const E=(0,Q.A)(V,[["__scopeId","data-v-bf9213de"]]);var S=E},50419:function(e,t,a){a.d(t,{A:function(){return m}});var l=a(20641),i=a(71029),o=a(50953),n=a(40834);const s={class:"SendEmail"},u={class:"email_section"};var r={__name:"SendEmail",props:{data:{type:Object,default:()=>({scope:{},props:{},type:""})}},setup(e){const t=(0,n.Pj)(),a=e,r=(0,o.KR)(null),d=(0,o.KR)("");function c(){const{type:e,props:t,scope:l}=a.data;"min"===e?d.value=t.meetingParticipant.invoiceEmail:"team"===e?d.value=t.team.invoiceEmail:"personal"===e?d.value=t.invoiceEmail:"group"===e?d.value=t.team.invoiceEmail:"committee"===e&&(d.value=l.invoiceEmail||"")}(0,l.sV)(()=>{c()});const m=(0,i.lq)(),g=(0,l.nI)().proxy;function p(){const{scope:e,type:l,props:i}=a.data;if(!d.value)return void g.$message({showClose:!0,message:"未填写发票邮箱",type:"warning"});const o=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;if(!1===o.test(d.value))return void g.$message({showClose:!0,message:"邮箱格式错误",type:"warning"});const n={email:d.value,meeting_id:m.query.meeting,user_id:"min"===l?i.meetingParticipant.userId:"",did:e.dataId,type_vue:1};"committee"===a.data.type&&(n.did=e.id,n.committee_id=t.state.user.committeeId);const s={min:"invoiceEmail",committee:"CommitteeInvoiceEmail"},u="committee"===a.data.type?"committee":"min";g.$message.success("操作成功"),g.$http.article[s[u]](n).then(e=>{200!==e.data.status&&1!==e.data.status||r.value?.hide()}).catch(e=>{console.error(e)})}return(e,t)=>{const a=(0,l.g2)("el-button"),i=(0,l.g2)("el-input"),o=(0,l.g2)("el-popover");return(0,l.uX)(),(0,l.CE)("div",s,[(0,l.bF)(o,{ref_key:"popover",ref:r,trigger:"click",width:"300",onShow:c},{reference:(0,l.k6)(()=>[(0,l.bF)(a,(0,l.v6)({type:"primary",size:"small"},e.$attrs),{default:(0,l.k6)(()=>[...t[1]||(t[1]=[(0,l.eW)("发票发送邮箱 ",-1)])]),_:1},16)]),default:(0,l.k6)(()=>[(0,l.Lk)("section",u,[(0,l.bF)(i,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e)},null,8,["modelValue"]),(0,l.bF)(a,{type:"primary",size:"small",onClick:p},{default:(0,l.k6)(()=>[...t[2]||(t[2]=[(0,l.eW)("确认 ",-1)])]),_:1})])]),_:1},512)])}}},d=a(66262);const c=(0,d.A)(r,[["__scopeId","data-v-7e731d1a"]]);var m=c},60894:function(e,t,a){a.d(t,{A:function(){return i}});var l=a(50953);function i(e){const t=(0,l.Kh)([{value:5,label:"数电增值税普通发票",num:6},{value:6,label:"数电增值税专用发票",num:6}]),a=(0,l.Kh)([{value:"0%",label:"0%",flag:!1},{value:"1%",label:"1%",flag:!1},{value:"2%",label:"2%",flag:!1},{value:"3%",label:"3%",flag:!1},{value:"4%",label:"4%",flag:!1},{value:"5%",label:"5%",flag:!1},{value:"6%",label:"6%",flag:!1},{value:"7%",label:"7%",flag:!1},{value:"8%",label:"8%",flag:!1},{value:"9%",label:"9%",flag:!1},{value:"10%",label:"10%",flag:!1},{value:"11%",label:"11%",flag:!1},{value:"12%",label:"12%",flag:!1},{value:"13%",label:"13%",flag:!1}]);function i(e,t){t.invoiceNo=e.kpCode}async function o(t,a){let l=[{}];const i={type_vue:1,name:t};e.$http.article.InvoiceAdmin_getDuty(i).then(e=>{1===e.data.status?(l=e.data.list,a(l)):(l=[],a(l))})}return{invoiceListType:t,TaxrateList:a,querySearchAsync:o,handleSelectMsg:i}}},67028:function(e,t,a){a(44114),a(18111),a(7588);var l=a(50953),i=a(20641),o=a(40834),n=a(71029);t.A=e=>{const t=(0,n.lq)(),a=(0,o.Pj)(),s=(0,l.KR)([]),u=(0,l.KR)({});function r(){const l={meetingId:t.query.meeting,type:1};let i="getQrCodeStatus";t.query.meeting||(l.committee_id=a.state.user.committeeId,i="CommitteeInvoiceGetQrCodeStatus"),e.$Loadimg.showLoading(),e.$http.article[i](l).then(t=>{e.$Loadimg.hideLoading(),(200===t.data.status||300===t.data.status)&&(s.value=t.data.list)})}const d=(0,i.EW)(()=>{let e=u.value?u.value:{};if(!e)return[];e.clerk&&(e={extNumberName:e.clerk,...e});let t=[];for(const a in e)if(Object.hasOwnProperty.call(e,a)&&a.match(/^extNumber.*(?<!Name)$/)&&null!==e[a]&&null!==e[a]){let l={};l=e[a+"Name"]?{name:e[a],Name:e[a+"Name"]}:{name:e[a]},t.push(l)}return t.length===s.value.length&&s.value.forEach((e,a)=>{t[a]={name:t[a].name,Name:t[a].Name,denglu:{},renzheng:{},...e},t[a].Name||delete t[a].Name}),t});return{CodeStatus:s,getQrCodeStatus:r,DigitalData:d,invoiceConfig:u}}},67608:function(e,t,a){a(69112);var l=a(20641),i=a(50953),o=a(71029),n=a(40834);t.A=()=>{const{proxy:e}=(0,l.nI)(),t=(0,n.Pj)(),a=(0,o.lq)(),s=(0,i.KR)(!1),u=(0,i.KR)(!1),r=(0,i.KR)(null),d=(0,i.KR)({type:"",props:{},scope:{}});(0,l.wB)(()=>u.value,e=>{e||(d.value={type:"",props:{},scope:{}})});const c=(0,i.Kh)({qrCode:"",QRCodetext:"",djs:120,yzm:"获取验证码",authentication:!1,DigitalLogin:!1,formRef:null,form:{extNumber:"",Digital:"",qrCode:""},rules:{extNumber:{required:!0,message:"",trigger:"change"},Digital:[{required:!0,message:"请输入验证码",trigger:"blur"},{validator:_,trigger:"blur",message:"请先选择开票人"}]},approveData:{},dialogVisible:!1,itemConfig:{},denglu:["未登录","已登录"],renzheng:["未知","已认证","待认证"],dlzt:["未登录","登录中(待输入校验码)","已登录"],rzzt:["失效","有效"]}),{denglu:m,renzheng:g,dlzt:p,rzzt:v,itemConfig:f}=(0,i.QW)(c),y=(0,i.KR)(1),k=(0,l.EW)(()=>c.form.extNumber?JSON.parse(c.form.extNumber).name:""),b=(0,l.EW)(()=>{let e=!1;const t=!!c.form.extNumber&&JSON.parse(c.form.extNumber);return c.itemConfig&&t&&(3===c.itemConfig.type?e="1"===t.denglu.result?.certificationStatus:4===c.itemConfig.type&&(e="2"===t.renzheng.list?.dlzt)),e});function _(e,t,a){""===k.value?a(new Error("请先选择开票人")):a()}function C(a,l){a={...a,type:y.value};let i="verifyFace";a.meetingId||(a.committee_id=t.state.user.committeeId,i="CommitteeInvoiceVerifyFace"),e.$Loadimg.showLoading(),e.$http.article[i](a).then(t=>{e.$Loadimg.hideLoading(),l(t)}).catch(t=>{e.$Loadimg.hideLoading(),console.error(t)})}function h(){if(k.value){const t={queryType:4,meetingId:a.query.meeting,clerkId:k.value};function l(){c.setTime=setInterval(()=>{c.djs--,c.yzm=`重新获取${c.djs}s`,c.djs<=0&&(clearInterval(c.setTime),c.djs=120,c.yzm="获取验证码")},1e3)}console.log(t),C(t,t=>{3===f.value.type?200===t.data.status?"E0000"!==t.data.list.code?e.$message.error(t.data.list.describe):(e.$message.success(t.data.list.describe),l()):300===t.data.status&&e.$message.error(t.data.msg):4===f.value.type&&("S0000"===t.data.list.status?e.$message.success(t.data.list.list.msg):"NEED_VERIFY_CODE"===t.data.list.status?(e.$message.error(t.data.list.list.msg),l()):(t.data.list.status,e.$message.error(t.data.list.list.msg)))})}}function R(t){c.formRef.validate(l=>{if(!l)return!1;{const l={queryType:2,number:c.form.Digital,clerkId:k.value,meetingId:a.query.meeting};C(l,a=>{3===f.value.type?(t(),c.DigitalLogin=!0,c.djs):4===f.value.type&&("S0000"===a.data.list.status?(t(),c.DigitalLogin=!0,c.djs,e.$message.success(a.data.list.list.msg)):("NEED_VERIFY_CODE"===a.data.list.status||a.data.list.status,e.$message.error(a.data.list.list.msg)))})}})}function D(t){const l={queryType:0,clerkId:k.value,authQrType:"税务局二维码"===c.form.qrCode?0:1,meetingId:a.query.meeting};C(l,t=>{if(3===f.value.type)"E0000"===t.data.list.code?(e.$message.success(t.data.list.describe),t.data.list.result&&(t.data.list.result&&t.data.list.result.qrCode?t.data.list.result&&t.data.list.result.qrCode&&(c.approveData=t.data.list.result,c.QRCodetext=t.data.list.result.qrCode):e.$message.error(t.data.list.result.message||"二维码生成失败，请重新操作"))):e.$message.error(t.data.list.describe);else if(4===f.value.type){if(console.log(t.data.list),"S0000"===t.data.list.status)return e.$message.success(t.data.list.list.msg),c.approveData=t.data.list.list,void(c.QRCodetext=t.data.list.list.ewmtx);"NEED_VERIFY_CODE"===t.data.list.status||t.data.list.status,e.$message.error(t.data.list.list.msg)}const l={queryType:1,meetingId:a.query.meeting,clerkId:k.value};C(l,t=>{if(3===f.value.type)"E0000"===t.data.list.code?(e.$message.success(t.data.list.describe),t.data.list.result&&(t.data.list.result&&t.data.list.result.qrCode?t.data.list.result&&t.data.list.result.qrCode&&(c.approveData=t.data.list.result,c.QRCodetext=t.data.list.result.qrCode):e.$message.error(t.data.list.result.message||"二维码生成失败，请重新操作"))):e.$message.error(t.data.list.describe);else if(4===f.value.type){if("S0000"===t.data.list.status)return e.$message.success(t.data.list.list.msg),c.approveData=t.data.list.list,void(c.QRCodetext=t.data.list.list.ewmtx);"NEED_VERIFY_CODE"===t.data.list.status||t.data.list.status,e.$message.error(t.data.list.list.msg)}})})}function L(e){120==c.djs&&(c.DigitalLogin=!1,c.QRCodetext="",c.approveData={},c.form={Digital:"",qrCode:"",extNumber:""}),c.dialogVisible=!1,e()}return{invoiceFlag:s,invoiceListType:y,cancellationDia:u,cancellationRef:r,cancellationType:d,figure:c,DigitalFlag:b,clerkId:k,DigitalAuthentication:D,Digitalrieister:R,Digitalold:h,dialogClose:L}}},78365:function(e,t,a){a.d(t,{A:function(){return u}});var l=a(20641),i=a(50953);const o={class:"paginated"};var n={__name:"index",props:["modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const a=e,n=t,s=(0,i.Kh)({page:1,per_page:10,total:0});(0,l.wB)(()=>a.modelValue,e=>{a.modelValue&&(s.page=e.page,s.per_page=e.per_page,s.total=e.total)});const{page:u,per_page:r,total:d}=(0,i.QW)(s),c=e=>{s.per_page=e},m=e=>{s.page=e};return(0,l.wB)(()=>s,e=>{n("update:modelValue",{...e})},{deep:!0}),(e,t)=>{const a=(0,l.g2)("el-pagination");return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.bF)(a,(0,l.v6)({"current-page":(0,i.R1)(u),"onUpdate:currentPage":t[0]||(t[0]=e=>(0,i.i9)(u)?u.value=e:null),"page-size":(0,i.R1)(r),"onUpdate:pageSize":t[1]||(t[1]=e=>(0,i.i9)(r)?r.value=e:null),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:(0,i.R1)(d),size:"small",onSizeChange:c,onCurrentChange:m},e.$attrs),null,16,["current-page","page-size","total"])])}}};const s=n;var u=s},86244:function(e,t,a){a.d(t,{A:function(){return d}});var l=a(20641),i=a(79118),o=a.n(i),n=a(50953);const s={class:"boxshow"};var u={__name:"qrcodejs2",props:{QRCodetext:{type:String,default:""},width:{type:Number,default:300},height:{type:Number,default:300}},setup(e,{expose:t}){const a=e,{QRCodetext:i}=(0,n.QW)(a),u=(0,n.KR)(null);function r(){u.value.innerHTML="";const e=new(o())(u.value,{width:a.width,height:a.height,text:a.QRCodetext?a.QRCodetext:"",colorDark:"#000",colorLight:"#fff",correctLevel:o().CorrectLevel.H});return e}return(0,l.wB)(()=>a.QRCodetext,()=>{(0,l.dY)(()=>{r()})}),(0,l.sV)(()=>{(0,l.dY)(()=>{r()})}),t({QRCodetext:i}),(e,t)=>((0,l.uX)(),(0,l.CE)("div",s,[(0,l.Lk)("div",{class:"qrcode",ref_key:"qrcodeContainer",ref:u},null,512)]))}};const r=u;var d=r}}]);