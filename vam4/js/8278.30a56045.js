"use strict";(self["webpackChunkmeetingvue3"]=self["webpackChunkmeetingvue3"]||[]).push([[8278],{28278:function(e,a,l){l.r(a),l.d(a,{default:function(){return h}});l(18111),l(61701);var t=l(20641),o=l(50953),n=l(90033),i=l(48548),s=(l(44114),l(22489),l(20116),l(7588),l(40834)),d=l(60894);const u={class:"AddGoos"},r={class:"content"},m={class:"bottom"};var c={__name:"index",props:{goods:{type:Object,default:()=>{},required:!0},dialogAdd:{type:Boolean,default:!0,required:!0}},emits:["handleSubmit","update:dialogAdd"],setup(e,{emit:a}){const{TaxrateList:l}=(0,d.A)(),c=(0,s.Pj)(),{proxy:p}=(0,t.nI)(),b=e,g=a,f=(0,o.Kh)({class_name:"",bm:"",Abbreviation:"",taxrate:"",specifications:"",company:"",formRef:null,rules:{class_name:{required:!0,message:"请输入项目名称"},bm:{required:!0,message:"请输入税收分类编码"},Abbreviation:{required:!0,message:"根据税收分类编码匹配"},taxrate:{required:!0,message:"输入税率/征收率"}},loading:!1,bmOptions:[],taxrateList:[...l]}),k=async e=>{await e.validate((e,a)=>{if(e){console.log("submit!"),console.log(f,"FormData");const e={committeeId:c.state.user.committeeId,class_name:f.class_name,bm:f.bm,name:f.Abbreviation,taxrate:f.taxrate,specifications:f.specifications,company:f.company,id:b.goods.id,type_vue:1};p.$Loadimg.showLoading(),p.$http.article.CommitteeInvoiceClassAdd(e).then(e=>{p.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status?(p.$message({type:"success",message:e.data.msg}),g("update:dialogAdd",!1)):p.$message({type:"error",message:e.data.msg})}).catch(e=>{console.error(e)})}else console.log("error submit!",a)})},_=(0,o.Kh)({search:"",treeData:[],propsTitle:{value:"bm",label:"mc",children:"children"},treeRef:null,height:window.innerHeight-45-55-50-52,bmList:[]}),{search:v,treeData:h,propsTitle:F,treeRef:y,height:L,bmList:x}=(0,o.QW)(_),R=e=>{y.value?.filter(e)};function w(){let e;console.log("FormData.class_name",f.class_name),e=f.class_name?_.bmList.filter(e=>e.gjz&&e.gjz.match(f.class_name)):V(_.bmList),_.treeData=e}const C=(e,a,l)=>{let t=W(l,l.data.mc,"mc"),o=t.includes(e);return e?!!o||void 0:(l.expanded=!1,!0)};function W(e,a,l){return e.parent&&e.parent.data[l]?(a+=e.parent.data[l],W(e.parent,a,l)):a}function V(e){const a={};e.forEach(e=>{"0"===e.pid&&(e.children=[]),a[e.bm]={...e}});for(const l in a)if(a.hasOwnProperty(l)){const e=a[l];"0"!==e.pid&&a[e.pid]&&(a[e.pid].children?a[e.pid].children.push(e):a[e.pid].children=[])}return Object.values(a).filter(e=>"0"===e.pid)}function A(){const e={type_vue:1};p.$Loadimg.showLoading(),p.$http.article.CommitteeInvoiceRevenueNumberList(e).then(e=>{p.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status?(_.bmList=e.data.list,(0,t.dY)(()=>{_.treeData=V(_.bmList)}),p.$message.success(e.data.msg)):p.$message.error(e.data.msg)})}function $(e){if(!e.children){const a=e.zzssl?e.zzssl.split("、"):[];f.taxrateList.map(e=>{e.flag=!!a.find(a=>a===e.value)}),f.taxrate=e.zzssl?a[0]:"0%",f.bm=e.bm,f.Abbreviation=e.spbmjc}}(0,t.sV)(()=>{A()});const z=e=>{e?(D.value=!0,N.value=_.bmList.filter(a=>a.bm.includes(e)),D.value=!1):N.value=[]};window.onresize=()=>{_.height=window.innerHeight-45-55-50-52};const{loading:D,class_name:I,bm:T,Abbreviation:U,taxrate:K,formRef:M,rules:B,bmOptions:N,taxrateList:j}=(0,o.QW)(f);return(0,t.wB)([()=>b.goods,()=>_.bmList],e=>{const[a,l]=e;if(a.id&&l.length>0){const e=l.find(e=>e.bm===a.bm);f.class_name=a.className,f.specifications=a.specifications,f.company=a.company,e.children=null,$(e)}},{immediate:!0}),(e,a)=>{const l=(0,t.g2)("el-input"),s=(0,t.g2)("el-form-item"),d=(0,t.g2)("el-option"),c=(0,t.g2)("el-select"),p=(0,t.g2)("el-popover"),b=(0,t.g2)("el-form"),_=(0,t.g2)("el-button"),x=(0,t.g2)("el-tree"),W=(0,t.g2)("el-scrollbar");return(0,t.uX)(),(0,t.CE)("div",u,[(0,t.Lk)("main",null,[(0,t.bF)(b,{"label-position":"top",model:f,ref_key:"formRef",ref:M,rules:(0,o.R1)(B)},{default:(0,t.k6)(()=>[(0,t.bF)(s,{label:"项目名称：",prop:"class_name"},{default:(0,t.k6)(()=>[(0,t.bF)(l,{modelValue:f.class_name,"onUpdate:modelValue":a[0]||(a[0]=e=>f.class_name=e),modelModifiers:{trim:!0},placeholder:"请输入项目名称",onBlur:w},null,8,["modelValue"])]),_:1}),(0,t.bF)(s,{label:"税收分类编码：",prop:"bm"},{default:(0,t.k6)(()=>[(0,t.bF)(c,{style:{width:"300px"},modelValue:f.bm,"onUpdate:modelValue":a[1]||(a[1]=e=>f.bm=e),modelModifiers:{trim:!0},filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入税收分类编码","remote-method":z,loading:(0,o.R1)(D)},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)((0,o.R1)(N),e=>((0,t.uX)(),(0,t.Wv)(d,{onClick:a=>$(e),key:e.bm,label:e.bm,value:e.bm},null,8,["onClick","label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),(0,t.bF)(s,{label:"简称：",prop:"Abbreviation"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{placement:"top",width:200,trigger:"click",content:"不可输入, 请在右侧商品和税收分类编码项选择项目"},{reference:(0,t.k6)(()=>[(0,t.bF)(l,{value:f.Abbreviation,placeholder:"根据税收分类编码匹配"},null,8,["value"])]),_:1})]),_:1}),(0,t.bF)(s,{label:"税率/征收率：",prop:"taxrate"},{default:(0,t.k6)(()=>[(0,t.bF)(c,{style:{width:"300px"},modelValue:f.taxrate,"onUpdate:modelValue":a[2]||(a[2]=e=>f.taxrate=e),modelModifiers:{trim:!0},placeholder:"请输入税率/征收率"},{prefix:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(f.taxrate&&((0,o.R1)(j).find(e=>e.value===f.taxrate).flag?"当前服务税率":"")),1)]),default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)((0,o.R1)(j),e=>((0,t.uX)(),(0,t.Wv)(d,{key:e.label,label:e.label,value:e.value},{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(e.label)+" "+(0,n.v_)(e.flag?"当前服务税率":""),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(s,{label:"规格型号：",prop:"company"},{default:(0,t.k6)(()=>[(0,t.bF)(l,{modelValue:f.specifications,"onUpdate:modelValue":a[3]||(a[3]=e=>f.specifications=e),modelModifiers:{trim:!0},placeholder:"请输入规格型号"},null,8,["modelValue"])]),_:1}),(0,t.bF)(s,{label:"单位：",prop:"company"},{default:(0,t.k6)(()=>[(0,t.bF)(l,{modelValue:f.company,"onUpdate:modelValue":a[4]||(a[4]=e=>f.company=e),modelModifiers:{trim:!0},placeholder:"请输入单位"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),(0,t.Lk)("section",null,[a[10]||(a[10]=(0,t.Lk)("header",null,[(0,t.Lk)("h1",null,"商品和服务税收分类编码")],-1)),(0,t.Lk)("div",r,[(0,t.bF)(l,{placeholder:"请输入",modelValue:(0,o.R1)(v),"onUpdate:modelValue":a[6]||(a[6]=e=>(0,o.i9)(v)?v.value=e:null),modelModifiers:{trim:!0},onInput:a[7]||(a[7]=e=>R((0,o.R1)(v)))},{append:(0,t.k6)(()=>[(0,t.bF)(_,{type:"primary",onClick:a[5]||(a[5]=e=>R((0,o.R1)(v))),icon:(0,o.R1)(i.Search)},null,8,["icon"])]),_:1},8,["modelValue"])]),(0,t.Lk)("div",m,[(0,t.bF)(W,{height:"100%"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{ref_key:"treeRef",ref:y,style:{"max-width":"600px"},"item-size":30,data:(0,o.R1)(h),props:(0,o.R1)(F),"filter-node-method":C,height:(0,o.R1)(L),onNodeClick:$},null,8,["data","props","height"])]),_:1})])])]),(0,t.Lk)("footer",null,[(0,t.bF)(_,{class:"btnFour",size:"small",onClick:a[8]||(a[8]=e=>g("update:dialogAdd",!1))},{default:(0,t.k6)(()=>[...a[11]||(a[11]=[(0,t.eW)("取消 ",-1)])]),_:1}),(0,t.bF)(_,{class:"btnFour",size:"small",type:"primary",onClick:a[9]||(a[9]=e=>k((0,o.R1)(M)))},{default:(0,t.k6)(()=>[...a[12]||(a[12]=[(0,t.eW)("保存 ",-1)])]),_:1})])])}}},p=l(66262);const b=(0,p.A)(c,[["__scopeId","data-v-1c294aa0"]]);var g=b;const f={class:"invoiceMaintain"},k={class:"box"};var _={__name:"index",setup(e){const a=(0,s.Pj)(),{proxy:l}=(0,t.nI)(),d=(0,o.Kh)({name:"",taxrate:"",formRef:null}),{name:u,taxrate:r,formRef:m}=(0,o.QW)(d);function c(e){e?.resetFields(),p()}function p(){const e={committeeId:a.state.user.committeeId,name:d.name,taxrate:d.taxrate,page:b.paginateData.page,per_page:b.paginateData.per_page,type_vue:1};b.loading=!0,l.$http.article.CommitteeInvoiceClassList(e).then(e=>{if(b.loading=!1,1===e.data.status||200===e.data.status){const a=e.data;b.tableData=a.list.list,b.paginateData={page:a.pageinfo.page,per_page:a.pageinfo.per_page,total:a.pageinfo.total},l.$message({type:"success",message:e.data.msg})}else l.$message({type:"error",message:e.data.msg})}).catch(e=>{console.error(e)})}const b=(0,o.Kh)({tableData:[],multipleTable:[],paginateData:{total:0,page:1,per_page:999},loading:!1}),{tableData:_,paginateData:v,loading:h}=(0,o.QW)(b);function F(e){b.multipleTable=e}function y(e){l.$confirm("是否当前所选项目信息，删除后此条数据无法恢复！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{x(e)}).catch(e=>{console.log(e)})}function L(){const e=b.multipleTable;if(0===e.length)return l.$message.error("请选择要删除的数据");l.$confirm("是否删除所选项目信息，删除后此条数据无法恢复！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{x(e)}).catch(e=>{console.log(e)})}function x(e){const t={committeeId:a.state.user.committeeId,type_vue:1};Array.isArray(e)?t.id=e.map(e=>e.id).join(","):t.id=e.id,l.$Loadimg.showLoading(),l.$http.article.CommitteeInvoiceClassDel(t).then(e=>{l.$Loadimg.hideLoading(),1===e.data.status||200===e.data.status?(l.$message({type:"success",message:"删除成功"}),p()):l.$message({type:"error",message:"删除失败"})}).catch(e=>{console.error(e)})}(0,t.wB)(()=>b.paginateData,(e,a)=>{e&&0!==a.total&&(a&&a.page===e.page&&a.per_page===e.per_page||p())},{deep:!0}),(0,t.wB)(()=>a.state.user.committeeId,()=>{p()}),(0,t.sV)(()=>{a.state.user.committeeId&&p()});const R=(0,o.Kh)({item:{},dialogDetails:!1}),{item:w,dialogDetails:C}=(0,o.QW)(R);function W(e){R.item=e,R.dialogDetails=!0}const V=(0,o.Kh)({dialogAdd:!1,goods:{}}),{dialogAdd:A,goods:$}=(0,o.QW)(V),z=()=>{p(),V.goods={}};function D(e){V.dialogAdd=!0,V.goods=e}return(e,a)=>{const l=(0,t.g2)("el-input"),s=(0,t.g2)("el-form-item"),u=(0,t.g2)("el-button"),r=(0,t.g2)("el-text"),b=(0,t.g2)("el-icon"),v=(0,t.g2)("el-form"),x=(0,t.g2)("el-table-column"),R=(0,t.g2)("el-table"),I=(0,t.g2)("el-dialog"),T=(0,t.g2)("el-drawer"),U=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",f,[(0,t.Lk)("div",k,[(0,t.Lk)("main",null,[a[16]||(a[16]=(0,t.Lk)("header",null,[(0,t.Lk)("div",{class:"blueLine"}," 项目信息分类 ")],-1)),(0,t.bF)(v,{model:d,ref_key:"formRef",ref:m},{default:(0,t.k6)(()=>[(0,t.bF)(s,{class:"topItem"},{default:(0,t.k6)(()=>[(0,t.Lk)("section",null,[(0,t.bF)(s,{label:"项目名:",prop:"name"},{default:(0,t.k6)(()=>[(0,t.bF)(l,{modelValue:d.name,"onUpdate:modelValue":a[0]||(a[0]=e=>d.name=e),modelModifiers:{trim:!0},placeholder:"请输入项目名"},null,8,["modelValue"])]),_:1}),(0,t.bF)(s,{label:"税率/税收:",prop:"taxrate"},{default:(0,t.k6)(()=>[(0,t.bF)(l,{modelValue:d.taxrate,"onUpdate:modelValue":a[1]||(a[1]=e=>d.taxrate=e),modelModifiers:{trim:!0},placeholder:"请输入税率/税收"},null,8,["modelValue"])]),_:1})]),(0,t.Lk)("section",null,[(0,t.bF)(u,{type:"primary",size:"small",onClick:p,loading:(0,o.R1)(h)},{default:(0,t.k6)(()=>[...a[9]||(a[9]=[(0,t.eW)("查询 ",-1)])]),_:1},8,["loading"]),(0,t.bF)(u,{size:"small",onClick:a[2]||(a[2]=e=>c((0,o.R1)(m))),loading:(0,o.R1)(h)},{default:(0,t.k6)(()=>[...a[10]||(a[10]=[(0,t.eW)("重置 ",-1)])]),_:1},8,["loading"])])]),_:1}),(0,t.bF)(s,null,{default:(0,t.k6)(()=>[(0,t.bF)(u,{type:"primary",size:"small",onClick:a[3]||(a[3]=e=>A.value=!0),loading:(0,o.R1)(h)},{default:(0,t.k6)(()=>[(0,t.bF)(r,{style:{color:"white"},size:"small"},{default:(0,t.k6)(()=>[...a[11]||(a[11]=[(0,t.eW)("添加 ",-1)])]),_:1}),(0,t.bF)(b,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(i.Plus))]),_:1})]),_:1},8,["loading"]),(0,t.bF)(u,{size:"small",onClick:L,type:"danger",loading:(0,o.R1)(h)},{default:(0,t.k6)(()=>[...a[12]||(a[12]=[(0,t.eW)(" 批量删除 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(R,{data:(0,o.R1)(_),onSelectionChange:F,width:"100%"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{type:"selection"}),(0,t.bF)(x,{label:"序号"},{default:(0,t.k6)(e=>[(0,t.Lk)("span",null,(0,n.v_)(e.$index+1),1)]),_:1}),(0,t.bF)(x,{label:"项目名称"},{default:(0,t.k6)(e=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(e.row.className),1)]),_:2},1024)]),_:1}),(0,t.bF)(x,{label:"税率/征收率"},{default:(0,t.k6)(e=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(e.row.taxrate),1)]),_:2},1024)]),_:1}),(0,t.bF)(x,{label:"规格型号"},{default:(0,t.k6)(e=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(e.row.specifications),1)]),_:2},1024)]),_:1}),(0,t.bF)(x,{label:"含税标志"},{default:(0,t.k6)(e=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)("0%"===e.row.taxrate?"否":"是"),1)]),_:2},1024)]),_:1}),(0,t.bF)(x,{label:"商品和服务税收分类编码"},{default:(0,t.k6)(e=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(e.row.bm),1)]),_:2},1024)]),_:1}),(0,t.bF)(x,{label:"商品和服务分类简称"},{default:(0,t.k6)(e=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(e.row.referredName),1)]),_:2},1024)]),_:1}),(0,t.bF)(x,{label:"操作",width:"200",flexd:"right"},{default:(0,t.k6)(e=>[(0,t.bF)(u,{size:"small",onClick:a=>W(e.row)},{default:(0,t.k6)(()=>[...a[13]||(a[13]=[(0,t.eW)("详情 ",-1)])]),_:1},8,["onClick"]),(0,t.bF)(u,{size:"small",type:"primary",onClick:a=>D(e.row)},{default:(0,t.k6)(()=>[...a[14]||(a[14]=[(0,t.eW)("修改 ",-1)])]),_:1},8,["onClick"]),(0,t.bF)(u,{size:"small",type:"danger",onClick:a=>y(e.row)},{default:(0,t.k6)(()=>[...a[15]||(a[15]=[(0,t.eW)("删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[U,(0,o.R1)(h)]])])]),(0,t.bF)(I,{title:"详情",modelValue:(0,o.R1)(C),"onUpdate:modelValue":a[5]||(a[5]=e=>(0,o.i9)(C)?C.value=e:null),class:"dialogDetails DiaHCenter",onClosed:a[6]||(a[6]=e=>w.value={})},{default:(0,t.k6)(()=>[(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,[a[17]||(a[17]=(0,t.Lk)("span",null,"项目名称：",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)((0,o.R1)(w).className),1)]),_:1})]),(0,t.Lk)("li",null,[a[18]||(a[18]=(0,t.Lk)("span",null,"商品和税收分类编码：",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)((0,o.R1)(w).bm),1)]),_:1})]),(0,t.Lk)("li",null,[a[19]||(a[19]=(0,t.Lk)("span",null,"商品和服务分类简称：",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)((0,o.R1)(w).referredName),1)]),_:1})]),(0,t.Lk)("li",null,[a[20]||(a[20]=(0,t.Lk)("span",null,"税率/征收率：",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)((0,o.R1)(w).taxrate),1)]),_:1})]),(0,t.Lk)("li",null,[a[21]||(a[21]=(0,t.Lk)("span",null,"是否含税：",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)("0%"===(0,o.R1)(w).taxrate?"否":"是"),1)]),_:1})])]),(0,t.Lk)("footer",null,[(0,t.bF)(u,{onClick:a[4]||(a[4]=e=>C.value=!1),size:"small",class:"btnFour"},{default:(0,t.k6)(()=>[...a[22]||(a[22]=[(0,t.eW)("关闭 ",-1)])]),_:1})])]),_:1},8,["modelValue"]),(0,t.bF)(T,{modelValue:(0,o.R1)(A),"onUpdate:modelValue":a[8]||(a[8]=e=>(0,o.i9)(A)?A.value=e:null),title:(0,o.R1)($).id?"修改":"添加",direction:"rtl",class:"dialogAddClass",onClosed:z,"modal-class":"dialog_modal",size:"50%","close-on-click-modal":!1},{default:(0,t.k6)(()=>[(0,o.R1)(A)?((0,t.uX)(),(0,t.Wv)(g,{key:0,dialogAdd:(0,o.R1)(A),"onUpdate:dialogAdd":a[7]||(a[7]=e=>(0,o.i9)(A)?A.value=e:null),onHandleSubmit:p,goods:V.goods},null,8,["dialogAdd","goods"])):(0,t.Q3)("",!0)]),_:1},8,["modelValue","title"])])}}};const v=(0,p.A)(_,[["__scopeId","data-v-8c61e07a"]]);var h=v},60894:function(e,a,l){l.d(a,{A:function(){return o}});var t=l(50953);function o(e){const a=(0,t.Kh)([{value:5,label:"数电增值税普通发票",num:6},{value:6,label:"数电增值税专用发票",num:6}]),l=(0,t.Kh)([{value:"0%",label:"0%",flag:!1},{value:"1%",label:"1%",flag:!1},{value:"2%",label:"2%",flag:!1},{value:"3%",label:"3%",flag:!1},{value:"4%",label:"4%",flag:!1},{value:"5%",label:"5%",flag:!1},{value:"6%",label:"6%",flag:!1},{value:"7%",label:"7%",flag:!1},{value:"8%",label:"8%",flag:!1},{value:"9%",label:"9%",flag:!1},{value:"10%",label:"10%",flag:!1},{value:"11%",label:"11%",flag:!1},{value:"12%",label:"12%",flag:!1},{value:"13%",label:"13%",flag:!1}]);function o(e,a){a.invoiceNo=e.kpCode}async function n(a,l){let t=[{}];const o={type_vue:1,name:a};e.$http.article.InvoiceAdmin_getDuty(o).then(e=>{1===e.data.status?(t=e.data.list,l(t)):(t=[],l(t))})}return{invoiceListType:a,TaxrateList:l,querySearchAsync:n,handleSelectMsg:o}}}}]);